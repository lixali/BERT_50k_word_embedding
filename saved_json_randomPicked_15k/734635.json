{
 "id": "734635",
 "text": "In mathematics, the Lucas sequences U_n(P,Q) and V_n(P, Q) are certain constant-recursive integer sequences that satisfy the recurrence relation : x_n = P \\cdot x_{n - 1} - Q \\cdot x_{n - 2} where P and Q are fixed integers. Any sequence satisfying this recurrence relation can be represented as a linear combination of the Lucas sequences U_n(P, Q) and V_n(P, Q). More generally, Lucas sequences U_n(P, Q) and V_n(P, Q) represent sequences of polynomials in P and Q with integer coefficients. Famous examples of Lucas sequences include the Fibonacci numbers, Mersenne numbers, Pell numbers, Lucas numbers, Jacobsthal numbers, and a superset of Fermat numbers. Lucas sequences are named after the French mathematician Édouard Lucas. == Recurrence relations == Given two integer parameters P and Q, the Lucas sequences of the first kind Un(P,Q) and of the second kind Vn(P,Q) are defined by the recurrence relations: :\\begin{align} U_0(P,Q)&=0, \\\\\\ U_1(P,Q)&=1, \\\\\\ U_n(P,Q)&=P\\cdot U_{n-1}(P,Q)-Q\\cdot U_{n-2}(P,Q) \\mbox{ for }n>1, \\end{align} and :\\begin{align} V_0(P,Q)&=2, \\\\\\ V_1(P,Q)&=P, \\\\\\ V_n(P,Q)&=P\\cdot V_{n-1}(P,Q)-Q\\cdot V_{n-2}(P,Q) \\mbox{ for }n>1. \\end{align} It is not hard to show that for n>0, :\\begin{align} U_n(P,Q)&=\\frac{P\\cdot U_{n-1}(P,Q) + V_{n-1}(P,Q)}{2}, \\\\\\ V_n(P,Q)&=\\frac{(P^2-4Q)\\cdot U_{n-1}(P,Q)+P\\cdot V_{n-1}(P,Q)}{2}. \\end{align} The above relations can be stated in matrix form as follows: : \\begin{bmatrix} U_n(P,Q)\\\\\\ U_{n+1}(P,Q)\\end{bmatrix} = \\begin{bmatrix} 0 & 1\\\\\\ -Q & P\\end{bmatrix}\\cdot \\begin{bmatrix} U_{n-1}(P,Q)\\\\\\ U_n(P,Q)\\end{bmatrix}, : \\begin{bmatrix} V_n(P,Q)\\\\\\ V_{n+1}(P,Q)\\end{bmatrix} = \\begin{bmatrix} 0 & 1\\\\\\ -Q & P\\end{bmatrix}\\cdot \\begin{bmatrix} V_{n-1}(P,Q)\\\\\\ V_n(P,Q)\\end{bmatrix}, : \\begin{bmatrix} U_n(P,Q)\\\\\\ V_n(P,Q)\\end{bmatrix} = \\begin{bmatrix} P/2 & 1/2\\\\\\ (P^2-4Q)/2 & P/2\\end{bmatrix}\\cdot \\begin{bmatrix} U_{n-1}(P,Q)\\\\\\ V_{n-1}(P,Q)\\end{bmatrix}. == Examples == Initial terms of Lucas sequences Un(P,Q) and Vn(P,Q) are given in the table: : \\begin{array}{r|l|l} n & U_n(P,Q) & V_n(P,Q) \\\\\\ \\hline 0 & 0 & 2 \\\\\\ 1 & 1 & P \\\\\\ 2 & P & {P}^{2}-2Q \\\\\\ 3 & {P}^{2}-Q & {P}^{3}-3PQ \\\\\\ 4 & {P}^{3}-2PQ & {P}^{4}-4{P}^{2}Q+2{Q}^{2} \\\\\\ 5 & {P}^{4}-3{P}^{2}Q+{Q}^{2} & {P}^{5}-5{P}^{3}Q+5P{Q}^{2} \\\\\\ 6 & {P}^{5}-4{P}^{3}Q+3P{Q}^{2} & {P}^{6}-6{P}^{4}Q+9{P}^{2}{Q}^{2}-2{Q}^{3} \\end{array} == Explicit expressions == The characteristic equation of the recurrence relation for Lucas sequences U_n(P,Q) and V_n(P,Q) is: :x^2 - Px + Q=0 \\, It has the discriminant D=P^2 - 4Q and the roots: :a = \\frac{P+\\sqrt{D}}2\\quad\\text{and}\\quad b = \\frac{P-\\sqrt{D}}2. \\, Thus: :a + b = P\\, , :a b = \\frac{1}{4}(P^2 - D) = Q\\, , :a - b = \\sqrt{D}\\, . Note that the sequence a^n and the sequence b^n also satisfy the recurrence relation. However these might not be integer sequences. === Distinct roots === When D e 0, a and b are distinct and one quickly verifies that :a^n = \\frac{V_n + U_n \\sqrt{D}}{2} :b^n = \\frac{V_n - U_n \\sqrt{D}}{2}. It follows that the terms of Lucas sequences can be expressed in terms of a and b as follows :U_n= \\frac{a^n-b^n}{a-b} = \\frac{a^n-b^n}{ \\sqrt{D}} :V_n=a^n+b^n \\, === Repeated root === The case D=0 occurs exactly when P=2S \\text{ and }Q=S^2 for some integer S so that a=b=S. In this case one easily finds that :U_n(P,Q)=U_n(2S,S^2) = nS^{n-1}\\, :V_n(P,Q)=V_n(2S,S^2)=2S^n\\,. == Properties == === Generating functions === The ordinary generating functions are : \\sum_{n\\ge 0} U_n(P,Q)z^n = \\frac{z}{1-Pz+Qz^2}; : \\sum_{n\\ge 0} V_n(P,Q)z^n = \\frac{2-Pz}{1-Pz+Qz^2}. === Pell equations === When Q=\\pm 1, the Lucas sequences U_n(P, Q) and V_n(P, Q) satisfy certain Pell equations: :V_n(P,1)^2 - D\\cdot U_n(P,1)^2 = 4, :V_{2n}(P,-1)^2 - D\\cdot U_{2n}(P,-1)^2 = 4, :V_{2n+1}(P,-1)^2 - D\\cdot U_{2n+1}(P,-1)^2 = -4. === Relations between sequences with different parameters === *For any number c, the sequences U_n(P', Q') and V_n(P', Q') with :: P' = P + 2c :: Q' = cP + Q + c^2 :have the same discriminant as U_n(P, Q) and V_n(P, Q): :: P'^2 - 4Q' = (P+2c)^2 - 4(cP + Q + c^2) = P^2 - 4Q = D. *For any number c, we also have :: U_n(cP,c^2Q) = c^{n-1}\\cdot U_n(P,Q), :: V_n(cP,c^2Q) = c^n\\cdot V_n(P,Q). === Other relations === The terms of Lucas sequences satisfy relations that are generalizations of those between Fibonacci numbers F_n=U_n(1,-1) and Lucas numbers L_n=V_n(1,-1). For example: : \\begin{array}{r|l} \\text{General case} & (P,Q) = (1,-1) \\\\\\ \\hline (P^2-4Q) U_n = {V_{n+1} - Q V_{n-1}}=2V_{n+1}-P V_n & 5F_n = {L_{n+1} + L_{n-1}}=2L_{n+1} - L_{n} \\\\\\ V_n = U_{n+1} - Q U_{n-1}=2U_{n+1}-PU_n & L_n = F_{n+1} + F_{n-1}=2F_{n+1}-F_n \\\\\\ U_{2n} = U_n V_n & F_{2n} = F_n L_n \\\\\\ V_{2n} = V_n^2 - 2Q^n & L_{2n} = L_n^2 - 2(-1)^n \\\\\\ U_{m+n} = U_n U_{m+1} - Q U_m U_{n-1}=\\frac{U_mV_n+U_nV_m}{2} & F_{m+n} = F_n F_{m+1} + F_m F_{n-1}=\\frac{F_mL_n+F_nL_m}{2} \\\\\\ V_{m+n} = V_m V_n - Q^n V_{m-n} = D U_m U_n + Q^n V_{m-n} & L_{m+n} = L_m L_n - (-1)^n L_{m-n} = 5 F_m F_n + (-1)^n L_{m-n} \\\\\\ V_n^2-DU_n^2=4Q^n & L_n^2-5F_n^2=4(-1)^n \\\\\\ U_n^2-U_{n-1}U_{n+1}=Q^{n-1} & F_n^2-F_{n-1}F_{n+1}=(-1)^{n-1} \\\\\\ V_n^2-V_{n-1}V_{n+1}=DQ^{n-1} & L_n^2-L_{n-1}L_{n+1}=5(-1)^{n-1} \\\\\\ DU_n=V_{n+1}-QV_{n-1} & F_n=\\frac{L_{n+1}+L_{n-1}}{5} \\\\\\ V_{m+n}=\\frac{V_mV_n+DU_mU_n}{2} & L_{m+n}=\\frac{L_mL_n+5F_mF_n}{2} \\\\\\ U_{m+n}=U_mV_n-Q^nU_{m-n} & F_{n+m}=F_mL_n-(-1)^nF_{m-n} \\\\\\ 2^{n-1}U_n={n \\choose 1}P^{n-1}+{n \\choose 3}P^{n-3}D+\\cdots & 2^{n-1}F_n={n \\choose 1}+5{n \\choose 3}+\\cdots \\\\\\ 2^{n-1}V_n=P^n+{n \\choose 2}P^{n-2}D+{n \\choose 4}P^{n-4}D^2+\\cdots & 2^{n-1}L_n=1+5{n \\choose 2}+5^2{n \\choose 4}+\\cdots \\end{array} === Divisibility properties === Among the consequences is that U_{km}(P,Q) is a multiple of U_m(P,Q), i.e., the sequence (U_m(P,Q))_{m\\ge1} is a divisibility sequence. This implies, in particular, that U_n(P,Q) can be prime only when n is prime. Another consequence is an analog of exponentiation by squaring that allows fast computation of U_n(P,Q) for large values of n. Moreover, if \\gcd(P,Q)=1, then (U_m(P,Q))_{m\\ge1} is a strong divisibility sequence. Other divisibility properties are as follows:For such relations and divisibility properties, see , or . * If n / m is odd, then V_m divides V_n. * Let N be an integer relatively prime to 2Q. If the smallest positive integer r for which N divides U_r exists, then the set of n for which N divides U_n is exactly the set of multiples of r. * If P and Q are even, then U_n, V_n are always even except U_1. * If P is even and Q is odd, then the parity of U_n is the same as n and V_n is always even. * If P is odd and Q is even, then U_n, V_n are always odd for n=1, 2, \\ldots. * If P and Q are odd, then U_n, V_n are even if and only if n is a multiple of 3. * If p is an odd prime, then U_p\\equiv\\left(\\tfrac{D}{p}\\right), V_p\\equiv P\\pmod{p} (see Legendre symbol). * If p is an odd prime and divides P and Q, then p divides U_n for every n>1. * If p is an odd prime and divides P but not Q, then p divides U_n if and only if n is even. * If p is an odd prime and divides not P but Q, then p never divides U_n for n=1, 2, \\ldots. * If p is an odd prime and divides not PQ but D, then p divides U_n if and only if p divides n. * If p is an odd prime and does not divide PQD, then p divides U_l, where l=p-\\left(\\tfrac{D}{p}\\right). The last fact generalizes Fermat's little theorem. These facts are used in the Lucas–Lehmer primality test. The converse of the last fact does not hold, as the converse of Fermat's little theorem does not hold. There exists a composite n relatively prime to D and dividing U_l, where l=n-\\left(\\tfrac{D}{n}\\right). Such a composite is called a Lucas pseudoprime. A prime factor of a term in a Lucas sequence that does not divide any earlier term in the sequence is called primitive. Carmichael's theorem states that all but finitely many of the terms in a Lucas sequence have a primitive prime factor. Indeed, Carmichael (1913) showed that if D is positive and n is not 1, 2 or 6, then U_n has a primitive prime factor. In the case D is negative, a deep result of Bilu, Hanrot, Voutier and Mignotte shows that if n > 30, then U_n has a primitive prime factor and determines all cases U_n has no primitive prime factor. == Specific names == The Lucas sequences for some values of P and Q have specific names: : : Fibonacci numbers : : Lucas numbers : : Pell numbers : : Pell–Lucas numbers (companion Pell numbers) : : Jacobsthal numbers : : Jacobsthal–Lucas numbers : : Mersenne numbers 2n − 1 : : Numbers of the form 2n + 1, which include the Fermat numbers : : The square roots of the square triangular numbers. : : Fibonacci polynomials : : Lucas polynomials : : Chebyshev polynomials of second kind : : Chebyshev polynomials of first kind multiplied by 2 : : Repunits base x : : xn \\+ 1 Some Lucas sequences have entries in the On-Line Encyclopedia of Integer Sequences: :{|class=\"wikitable\" style=\"background: #fff\" |- !P\\,!!Q\\, !!U_n(P,Q)\\, !! V_n(P,Q)\\, |- | −1 || 3 || |- | 1 || −1 || || |- | 1 || 1 || || |- | 1 || 2 || || |- | 2 || −1 || || |- | 2 || 1 || |- | 2 || 2 || || |- | 2 || 3 || |- | 2 || 4 || |- | 2 || 5 || |- | 3 || −5 || || |- | 3 || −4 || || |- | 3 || −3 || || |- | 3 || −2 || || |- | 3 || −1 || || |- | 3 || 1 || || |- | 3 || 2 || || |- | 3 || 5 || |- | 4 || −3 || || |- | 4 || −2 || |- | 4 || −1 || || |- | 4 || 1 || || |- | 4 || 2 || || |- | 4 || 3 || || |- | 4 || 4 || |- | 5 || −3 || |- | 5 || −2 || |- | 5 || −1 || || |- | 5 || 1 || || |- | 5 || 4 || || |- | 6 || 1 || || |} ==Applications== * Lucas sequences are used in probabilistic Lucas pseudoprime tests, which are part of the commonly used Baillie–PSW primality test. * Lucas sequences are used in some primality proof methods, including the Lucas–Lehmer–Riesel test, and the N+1 and hybrid N-1/N+1 methods such as those in Brillhart-Lehmer-Selfridge 1975 * LUC is a public-key cryptosystem based on Lucas sequences that implements the analogs of ElGamal (LUCELG), Diffie–Hellman (LUCDIF), and RSA (LUCRSA). The encryption of the message in LUC is computed as a term of certain Lucas sequence, instead of using modular exponentiation as in RSA or Diffie–Hellman. However, a paper by Bleichenbacher et al. shows that many of the supposed security advantages of LUC over cryptosystems based on modular exponentiation are either not present, or not as substantial as claimed. ==See also== * Lucas pseudoprime * Frobenius pseudoprime * Somer–Lucas pseudoprime ==Notes== ==References== * * * * * * * * * * * * * * Lucas sequence at Encyclopedia of Mathematics. * * Category:Recurrence relations Category:Integer sequences",
 "title": "Lucas sequence"
}