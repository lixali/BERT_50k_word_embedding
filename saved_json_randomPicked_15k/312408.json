{
 "id": "312408",
 "text": "In probability theory, the law of total varianceNeil A. Weiss, A Course in Probability, Addison-Wesley, 2005, pages 385-386. or variance decomposition formula or conditional variance formulas or law of iterated variances also known as Eve's law, Joseph K. Blitzstein and Jessica Hwang: \"Introduction to Probability\" states that if X and Y are random variables on the same probability space, and the variance of Y is finite, then \\operatorname{Var}(Y) = \\operatorname{E}[\\operatorname{Var}(Y \\mid X)] + \\operatorname{Var}(\\operatorname{E}[Y \\mid X]). In language perhaps better known to statisticians than to probability theorists, the two terms are the \"unexplained\" and the \"explained\" components of the variance respectively (cf. fraction of variance unexplained, explained variation). In actuarial science, specifically credibility theory, the first component is called the expected value of the process variance (EVPV) and the second is called the variance of the hypothetical means (VHM). These two components are also the source of the term \"Eve's law\", from the initials EV VE for \"expectation of variance\" and \"variance of expectation\". ==Formulation== There is a general variance decomposition formula for c \\geq 2 components (see below).Bowsher, C.G. and P.S. Swain, Identifying sources of variation and the flow of information in biochemical networks, PNAS May 15, 2012 109 (20) E1320-E1328. For example, with two conditioning random variables: \\operatorname{Var}[Y] = \\operatorname{E}\\left[\\operatorname{Var}\\left(Y \\mid X_1, X_2\\right)\\right] + \\operatorname{E}[\\operatorname{Var}(\\operatorname{E}\\left[Y \\mid X_1, X_2\\right] \\mid X_1)] + \\operatorname{Var}(\\operatorname{E}\\left[Y \\mid X_1\\right]), which follows from the law of total conditional variance: \\operatorname{Var}(Y \\mid X_1) = \\operatorname{E} \\left[\\operatorname{Var}(Y \\mid X_1, X_2) \\mid X_1\\right] + \\operatorname{Var} \\left(\\operatorname{E}\\left[Y \\mid X_1, X_2 \\right] \\mid X_1\\right). Note that the conditional expected value \\operatorname{E}(Y \\mid X) is a random variable in its own right, whose value depends on the value of X. Notice that the conditional expected value of Y given the X = x is a function of x (this is where adherence to the conventional and rigidly case-sensitive notation of probability theory becomes important!). If we write \\operatorname{E}(Y \\mid X = x) = g(x) then the random variable \\operatorname{E}(Y \\mid X) is just g(X). Similar comments apply to the conditional variance. One special case, (similar to the law of total expectation) states that if A_1, \\ldots, A_n is a partition of the whole outcome space, that is, these events are mutually exclusive and exhaustive, then \\begin{align} \\operatorname{Var} (X) = {} & \\sum_{i=1}^n \\operatorname{Var}(X\\mid A_i) \\Pr(A_i) + \\sum_{i=1}^n \\operatorname{E}[X\\mid A_i]^2 (1-\\Pr(A_i))\\Pr(A_i) \\\\\\\\[4pt] & {} - 2\\sum_{i=2}^n \\sum_{j=1}^{i-1} \\operatorname{E}[X \\mid A_i] \\Pr(A_i)\\operatorname{E}[X\\mid A_j] \\Pr(A_j). \\end{align} In this formula, the first component is the expectation of the conditional variance; the other two components are the variance of the conditional expectation. ==Proof== The law of total variance can be proved using the law of total expectation.Neil A. Weiss, A Course in Probability, Addison-Wesley, 2005, pages 380-383. First, \\operatorname{Var}[Y] = \\operatorname{E}\\left[Y^2\\right] - \\operatorname{E}[Y]^2 from the definition of variance. Again, from the definition of variance, and applying the law of total expectation, we have \\operatorname{E}\\left[Y^2\\right] = \\operatorname{E}\\left[\\operatorname{E}[Y^2\\mid X]\\right] = \\operatorname{E} \\left[\\operatorname{Var}[Y \\mid X] + [\\operatorname{E}[Y \\mid X]]^2\\right]. Now we rewrite the conditional second moment of Y in terms of its variance and first moment, and apply the law of total expectation on the right hand side: \\operatorname{E}\\left[Y^2\\right] - \\operatorname{E}[Y]^2 = \\operatorname{E} \\left[\\operatorname{Var}[Y \\mid X] + [\\operatorname{E}[Y \\mid X]]^2\\right] - [\\operatorname{E} [\\operatorname{E}[Y \\mid X]]]^2. Since the expectation of a sum is the sum of expectations, the terms can now be regrouped: = \\left(\\operatorname{E} [\\operatorname{Var}[Y \\mid X]]\\right) + \\left(\\operatorname{E} \\left[\\operatorname{E}[Y \\mid X]^2\\right] - [\\operatorname{E} [\\operatorname{E}[Y \\mid X]]]^2\\right). Finally, we recognize the terms in the second set of parentheses as the variance of the conditional expectation \\operatorname{E}[Y \\mid X]: = \\operatorname{E} [\\operatorname{Var}[Y \\mid X]] + \\operatorname{Var} [\\operatorname{E}[Y \\mid X]]. ==General variance decomposition applicable to dynamic systems== The following formula shows how to apply the general, measure theoretic variance decomposition formula to stochastic dynamic systems. Let Y(t) be the value of a system variable at time t. Suppose we have the internal histories (natural filtrations) H_{1t},H_{2t},\\ldots,H_{c-1,t}, each one corresponding to the history (trajectory) of a different collection of system variables. The collections need not be disjoint. The variance of Y(t) can be decomposed, for all times t, into c \\geq 2 components as follows: \\begin{align} \\operatorname{Var}[Y(t)] = {} & \\operatorname{E}(\\operatorname{Var}[Y(t)\\mid H_{1t},H_{2t},\\ldots,H_{c-1,t}]) \\\\\\\\[4pt] & {} + \\sum_{j=2}^{c-1}\\operatorname{E}(\\operatorname{Var}[\\operatorname{E}[Y(t)\\mid H_{1t},H_{2t},\\ldots,H_{jt}] \\mid H_{1t},H_{2t},\\ldots,H_{j-1,t}]) \\\\\\\\[4pt] & {} + \\operatorname{Var}(\\operatorname{E}[Y(t)\\mid H_{1t}]). \\end{align} The decomposition is not unique. It depends on the order of the conditioning in the sequential decomposition. ==The square of the correlation and explained (or informational) variation== In cases where (Y, X) are such that the conditional expected value is linear; that is, in cases where \\operatorname{E}(Y \\mid X) = a X + b, it follows from the bilinearity of covariance that a={\\operatorname{Cov}(Y, X) \\over \\operatorname{Var}(X)} and b = \\operatorname{E}(Y)-{\\operatorname{Cov}(Y, X) \\over \\operatorname{Var}(X)} \\operatorname{E}(X) and the explained component of the variance divided by the total variance is just the square of the correlation between Y and X; that is, in such cases, {\\operatorname{Var}(\\operatorname{E}(Y \\mid X)) \\over \\operatorname{Var}(Y)} = \\operatorname{Corr}(X, Y)^2. One example of this situation is when (X, Y) have a bivariate normal (Gaussian) distribution. More generally, when the conditional expectation \\operatorname{E}(Y \\mid X) is a non-linear function of X \\iota_{Y\\mid X} = {\\operatorname{Var}(\\operatorname{E}(Y \\mid X)) \\over \\operatorname{Var}(Y)} = \\operatorname{Corr}(\\operatorname{E}(Y \\mid X), Y)^2, which can be estimated as the R squared from a non-linear regression of Y on X, using data drawn from the joint distribution of (X, Y). When \\operatorname{E}(Y \\mid X) has a Gaussian distribution (and is an invertible function of X), or Y itself has a (marginal) Gaussian distribution, this explained component of variation sets a lower bound on the mutual information: \\operatorname{I}(Y; X) \\geq \\ln \\left([1 - \\iota_{Y \\mid X}]^{-1/2}\\right). ==Higher moments== A similar law for the third central moment \\mu_3 says \\mu_3(Y)=\\operatorname{E}\\left(\\mu_3(Y \\mid X)\\right) + \\mu_3(\\operatorname{E}(Y \\mid X)) + 3\\operatorname{cov}(\\operatorname{E}(Y \\mid X), \\operatorname{var}(Y \\mid X)). For higher cumulants, a generalization exists. See law of total cumulance. ==See also== * âˆ’ a generalization * ==References== * * (Problem 34.10(b)) Category:Algebra of random variables Category:Statistical deviation and dispersion Category:Articles containing proofs Category:Theory of probability distributions Category:Theorems in statistics Category:Statistical laws",
 "title": "Law of total variance"
}